---
- name: Bring up docker containers
  hosts: localhost
  vars_files:
    - vars/cloud-inventory.yml
  roles:
    - {
      role: provision_docker,
      provision_docker_privileged: "{{ true }}",
      provision_docker_inventory: "{{ container_inventory }}"
    }

- name: Run tests
  hosts: docker_containers
  vars_files:
    - var/test.yml
  roles:
    - rh-jboss-common

- name: Remove docker containers
  hosts: docker_containers
  vars_files:
    - vars/cloud-inventory.yml
  tasks:
  - name: Delete container
    local_action:
      module: docker
      name: "{{ item.name }}"
      state: absent
      image: "{{ item.image }}"
    with_items:
    - "{{ container_inventory }}"
